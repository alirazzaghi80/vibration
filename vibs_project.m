clc, clear all,close all;
% //////////To find frequency(chapter3)//////////////////////////////////////////////////////////////////////////////////////////////////////
m1=270,m2=520,m3=340,m4=4400,m5=12500,I1=18311,I2=251900;
kt1=847000,kt2=2000000,kt3=2000000,ks1=300000,ks2=967430,ks3=155800,ks4=20000000;
cd4=200000,cs1=10000,cs2=27627,cs3=44506;
L1=1.2,L2=4.8,L3=4,L4=4.134,L5=6.973;
%//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
M=[m1 ,0 ,0 ,0 ,0 ,0 ,0  ;
   0  ,m2,0 ,0 ,0 ,0 ,0  ;
   0  ,0 ,m3,0 ,0 ,0 ,0  ;
   0  ,0 ,0 ,m4,0 ,0 ,0  ; 
   0  ,0 ,0 ,0 ,m5,0 ,0  ;
   0  ,0 ,0 ,0 ,0 ,I1,0  ;
   0  ,0 ,0 ,0 ,0 ,0 ,I2];
%/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
C=[cs1       ,0        ,0        ,-cs1                   ,0              ,L1*cs1                       ,0                  ;
    0        ,cs2      ,0        ,-cs2                   ,0              ,-L2*cs2                      ,0                  ;
    0        ,0        ,cs3      ,0                      ,-cs3           ,0                            ,-L3*cs3            ;
    -cs1     ,-cs2     ,0        ,cs1+cs2+cd4            ,-cd4           ,L2*cs2-L1*cs1+L4*cd4         ,L5*cd4             ;
    0        ,0        ,-cs3     ,-cd4                   ,cd4+cs3        ,-L4*cd4                      ,L3*cs3-L5*cd4      ;
    L1*cs1   ,-L2*cs2  ,0        ,-L1*cs1+L2*cs2+L4*cd4  ,-L4*cd4        ,L1^2*cs1+L2^2*cs2+L4^2*cd4   ,L5*L4*cd4          ;
    0        ,0        ,-L3*cs3  ,L5*cd4                 ,L3*cs3-L5*cd4  ,L5*L4*cd4                    ,L5^2*cd4+L3^2*cs3  ;];
%//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
K=[kt1+ks1,0       ,0       ,-ks1                  ,0                      ,L1*ks1                        ,0;
    0     ,kt2+ks2 ,0       ,-ks2                  ,0                      ,-L2*ks2                       ,0;
    0     ,0       ,kt3+ks3 ,0                     ,-ks3                   ,0                             ,-L3*ks3;
    -ks1  ,-ks2    ,0       ,ks1+ks2+ks4           ,-ks4                   ,L2*ks2-L1*ks1+L4*ks4          ,L5*ks4;
    0     ,0       ,-ks3    ,-ks4                  ,ks4+ks3                ,-L4*ks4                       ,L3*ks3-L5*ks4    ;
    L1*ks1,-L2*ks2 ,0       ,-L1*ks1+L2*ks2+L4*ks4 ,-L4*ks4                ,L1^2*ks1+L2^2*ks2+L4^2*ks4    ,L5*L4*ks4       ;
    0     ,0       ,-L3*ks3 ,L5*ks4                ,L3*ks3-L5*ks4          ,L5*L4*ks4                     ,L5^2*ks4+L3^2*ks3];
%///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
[m w2]=eig(K,M);
omega = [w2].^(1/2);
%//////////(chapter4)///////////////////////////////////////////////////////////////////////////////////////////////////////////////
v=80;
V=v/3.6; 
t1=0; 
t2=t1+(L1+L2)/V; 
t3=t2+(L5+L4+L3-L2)/V ;
%//////////(chapter5)////////////////////////////////////////////////////////////////////////////////////////////////////////
L_Y=2; 
t_Y=L_Y/V; 
Y=0.1; 
%//////////(chapter6)////////////////////////////////////////////////////////////////////////////////////////////////////////
V_a=[0.5,1,2,10,20,40,80];
a_4max=[4.92e+05,4.92e+05,4.92e+05,4.92e+05,4.92e+05,4.92e+05,4.92e+05];
a_5max=[5.71e+02,1.14e+03,2.27e+03,2.33e+04,2.35e+04,2.94e+04,4.15e+04];

subplot(2,1,1);
plot(V_a,a_4max)
title('part4')
xlabel('velocity(m/s)')
ylabel('maximum acceleration(m/s^2)')

subplot(2,1,2);
plot(V_a,a_5max)
title('part5')
xlabel('velocity(m/s)')
ylabel('maximum acceleration(m/s^2)')
%///// End of program //////////////////////////////////////////////////////


